<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Gradients for GCP services -->
    <linearGradient id="storageGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4285f4;stop-opacity:0.15"/>
      <stop offset="100%" style="stop-color:#4285f4;stop-opacity:0.25"/>
    </linearGradient>
    <linearGradient id="functionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ea4335;stop-opacity:0.15"/>
      <stop offset="100%" style="stop-color:#ea4335;stop-opacity:0.25"/>
    </linearGradient>
    <linearGradient id="bigqueryGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fbbc04;stop-opacity:0.15"/>
      <stop offset="100%" style="stop-color:#fbbc04;stop-opacity:0.25"/>
    </linearGradient>
    <linearGradient id="lookerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#34a853;stop-opacity:0.15"/>
      <stop offset="100%" style="stop-color:#34a853;stop-opacity:0.25"/>
    </linearGradient>
    
    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="12" markerHeight="8" 
            refX="11" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#2d3748" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="1000" fill="#ffffff"/>
  
  <!-- Title -->
  <text x="700" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#1a202c">
    GCP CSV Ingestion Pipeline Architecture
  </text>
  
  <!-- Main Pipeline Flow -->
  <g id="pipeline-flow">
    
    <!-- Step 1: CSV Files -->
    <g id="csv-files">
      <rect x="80" y="120" width="200" height="120" rx="12" fill="#f7fafc" stroke="#e2e8f0" stroke-width="2"/>
      
      <!-- CSV Icon -->
      <rect x="100" y="140" width="40" height="30" rx="3" fill="#e6fffa" stroke="#38b2ac" stroke-width="2"/>
      <line x1="107" y1="150" x2="133" y2="150" stroke="#38b2ac" stroke-width="1.5"/>
      <line x1="107" y1="155" x2="130" y2="155" stroke="#38b2ac" stroke-width="1.5"/>
      <line x1="107" y1="160" x2="133" y2="160" stroke="#38b2ac" stroke-width="1.5"/>
      <line x1="107" y1="165" x2="125" y2="165" stroke="#38b2ac" stroke-width="1.5"/>
      
      <text x="180" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1a202c">CSV Files</text>
      <text x="180" y="180" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">sales.csv</text>
      <text x="180" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">products.csv</text>
      <text x="180" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">customers.csv</text>
    </g>

    <!-- Arrow 1 -->
    <line x1="300" y1="180" x2="360" y2="180" stroke="#2d3748" stroke-width="3" marker-end="url(#arrowhead)"/>
    <text x="330" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#4a5568">Upload</text>

    <!-- Step 2: Cloud Storage -->
    <g id="cloud-storage">
      <rect x="380" y="120" width="240" height="120" rx="12" fill="url(#storageGradient)" stroke="#4285f4" stroke-width="2"/>
      
      <!-- Storage Icon -->
      <circle cx="430" cy="165" r="20" fill="#4285f4" opacity="0.1"/>
      <circle cx="430" cy="165" r="15" fill="none" stroke="#4285f4" stroke-width="3"/>
      <circle cx="430" cy="165" r="8" fill="#4285f4"/>
      
      <text x="480" y="160" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#4285f4">Cloud Storage</text>
      <text x="480" y="180" font-family="Arial, sans-serif" font-size="13" fill="#1a202c">Bucket: raw-data-bucket</text>
      <text x="480" y="200" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Auto-trigger on upload</text>
      <text x="480" y="215" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Event: object.finalize</text>
    </g>

    <!-- Arrow 2 -->
    <line x1="640" y1="180" x2="700" y2="180" stroke="#2d3748" stroke-width="3" marker-end="url(#arrowhead)"/>
    <text x="670" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#4a5568">Trigger</text>

    <!-- Step 3: Cloud Function -->
    <g id="cloud-function">
      <rect x="720" y="120" width="240" height="120" rx="12" fill="url(#functionGradient)" stroke="#ea4335" stroke-width="2"/>
      
      <!-- Function Icon -->
      <rect x="760" y="155" width="30" height="30" rx="6" fill="#ea4335" opacity="0.2"/>
      <text x="775" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ea4335">λ</text>
      
      <text x="810" y="160" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#ea4335">Cloud Function</text>
      <text x="810" y="180" font-family="Arial, sans-serif" font-size="13" fill="#1a202c">csv-loader-fn</text>
      <text x="810" y="200" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Python 3.10 Runtime</text>
      <text x="810" y="215" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">256MB Memory</text>
    </g>

    <!-- Arrow 3 -->
    <line x1="980" y1="180" x2="1040" y2="180" stroke="#2d3748" stroke-width="3" marker-end="url(#arrowhead)"/>
    <text x="1010" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#4a5568">Load Data</text>

    <!-- Step 4: BigQuery -->
    <g id="bigquery">
      <rect x="1060" y="120" width="240" height="120" rx="12" fill="url(#bigqueryGradient)" stroke="#fbbc04" stroke-width="2"/>
      
      <!-- BigQuery Icon -->
      <rect x="1100" y="155" width="30" height="30" rx="4" fill="#fbbc04" opacity="0.2"/>
      <rect x="1105" y="160" width="20" height="4" fill="#fbbc04"/>
      <rect x="1105" y="166" width="20" height="4" fill="#fbbc04"/>
      <rect x="1105" y="172" width="20" height="4" fill="#fbbc04"/>
      <rect x="1105" y="178" width="20" height="4" fill="#fbbc04"/>
      
      <text x="1150" y="160" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#fbbc04">BigQuery</text>
      <text x="1150" y="180" font-family="Arial, sans-serif" font-size="13" fill="#1a202c">Dataset: sales_data</text>
      <text x="1150" y="200" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Table: sales</text>
      <text x="1150" y="215" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Auto-detect schema</text>
    </g>
  </g>

  <!-- Vertical Arrow to Looker -->
  <line x1="1180" y1="260" x2="1180" y2="320" stroke="#2d3748" stroke-width="3" marker-end="url(#arrowhead)"/>
  <text x="1210" y="290" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#4a5568">Query Data</text>

  <!-- Step 5: Google Looker -->
  <g id="looker">
    <rect x="1060" y="340" width="240" height="120" rx="12" fill="url(#lookerGradient)" stroke="#34a853" stroke-width="2"/>
    
    <!-- Looker Chart Icon -->
    <rect x="1100" y="375" width="30" height="25" rx="3" fill="none" stroke="#34a853" stroke-width="2"/>
    <polyline points="1105,395 1110,385 1115,390 1120,380 1125,388" fill="none" stroke="#34a853" stroke-width="2"/>
    
    <text x="1150" y="380" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#34a853">Google Looker</text>
    <text x="1150" y="400" font-family="Arial, sans-serif" font-size="13" fill="#1a202c">Interactive Dashboards</text>
    <text x="1150" y="420" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Sales Analytics &amp; Reports</text>
    <text x="1150" y="435" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">Real-time Visualizations</text>
  </g>

  <!-- Terraform Management Box - PROPERLY SIZED AND POSITIONED -->
  <g id="terraform">
    <rect x="80" y="290" width="360" height="170" rx="12" fill="#f7fafc" stroke="#805ad5" stroke-width="3" stroke-dasharray="8,4"/>
    
    <!-- Terraform Icon -->
    <polygon points="120,320 135,328 135,342 120,350 105,342 105,328" fill="#805ad5" opacity="0.3"/>
    <text x="120" y="338" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#805ad5">T</text>
    
    <text x="160" y="330" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#805ad5">Terraform</text>
    <text x="160" y="350" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Infrastructure as Code</text>
    
    <!-- Managed Components - Better organized with proper spacing -->
    <text x="100" y="380" font-family="Arial, sans-serif" font-size="13" font-weight="500" fill="#4a5568">Manages Infrastructure:</text>
    
    <!-- Left column -->
    <text x="110" y="405" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">• Cloud Storage Bucket</text>
    <text x="110" y="420" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">• Cloud Function Deployment</text>
    <text x="110" y="435" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">• IAM Roles &amp; Permissions</text>
    
    <!-- Right column -->
    <text x="270" y="405" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">• BigQuery Dataset</text>
    <text x="270" y="420" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">• Event Triggers</text>
    <text x="270" y="435" font-family="Arial, sans-serif" font-size="12" fill="#4a5568">• Resource Dependencies</text>
  </g>

  <!-- Data Flow Process - Moved down for better spacing -->
  <g id="process-flow">
    <text x="80" y="520" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1a202c">Data Flow Process:</text>
    
    <!-- Step indicators with consistent positioning -->
    <g id="step-1">
      <circle cx="100" cy="550" r="12" fill="#4285f4"/>
      <text x="100" cy="557" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">1</text>
      <text x="125" y="557" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">CSV files uploaded to Cloud Storage bucket</text>
    </g>
    
    <g id="step-2">
      <circle cx="100" cy="580" r="12" fill="#ea4335"/>
      <text x="100" cy="587" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">2</text>
      <text x="125" y="587" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Cloud Function triggered automatically on file upload event</text>
    </g>
    
    <g id="step-3">
      <circle cx="100" cy="610" r="12" fill="#fbbc04"/>
      <text x="100" cy="617" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">3</text>
      <text x="125" y="617" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Function validates CSV format and loads data to BigQuery with auto-schema detection</text>
    </g>
    
    <g id="step-4">
      <circle cx="100" cy="640" r="12" fill="#34a853"/>
      <text x="100" cy="647" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">4</text>
      <text x="125" y="647" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Google Looker connects to BigQuery for interactive data visualization and analytics</text>
    </g>
    
    <g id="step-5">
      <circle cx="100" cy="670" r="12" fill="#805ad5"/>
      <text x="100" cy="677" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">5</text>
      <text x="125" y="677" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Terraform provisions and manages all infrastructure components</text>
    </g>
  </g>

  <!-- Key Features - Better alignment and spacing -->
  <g id="features">
    <text x="700" y="520" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1a202c">Key Features:</text>
    
    <g id="feature-1">
      <rect x="720" y="540" width="18" height="18" rx="3" fill="#e6fffa" stroke="#38b2ac" stroke-width="2"/>
      <text x="729" y="552" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#38b2ac">✓</text>
      <text x="750" y="554" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Serverless &amp; Auto-scaling Architecture</text>
    </g>
    
    <g id="feature-2">
      <rect x="720" y="570" width="18" height="18" rx="3" fill="#e6fffa" stroke="#38b2ac" stroke-width="2"/>
      <text x="729" y="582" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#38b2ac">✓</text>
      <text x="750" y="584" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Automatic Schema Detection &amp; Validation</text>
    </g>
    
    <g id="feature-3">
      <rect x="720" y="600" width="18" height="18" rx="3" fill="#e6fffa" stroke="#38b2ac" stroke-width="2"/>
      <text x="729" y="612" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#38b2ac">✓</text>
      <text x="750" y="614" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Real-time Data Processing &amp; Loading</text>
    </g>
    
    <g id="feature-4">
      <rect x="720" y="630" width="18" height="18" rx="3" fill="#e6fffa" stroke="#38b2ac" stroke-width="2"/>
      <text x="729" y="642" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#38b2ac">✓</text>
      <text x="750" y="644" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Interactive Dashboards &amp; Analytics</text>
    </g>
    
    <g id="feature-5">
      <rect x="720" y="660" width="18" height="18" rx="3" fill="#e6fffa" stroke="#38b2ac" stroke-width="2"/>
      <text x="729" y="672" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#38b2ac">✓</text>
      <text x="750" y="674" font-family="Arial, sans-serif" font-size="14" fill="#1a202c">Complete Infrastructure as Code</text>
    </g>
  </g>

  <!-- Technology Stack - Improved layout and spacing -->
  <g id="tech-stack">
    <rect x="80" y="730" width="620" height="160" rx="8" fill="#f7fafc" stroke="#e2e8f0" stroke-width="2"/>
    <text x="390" y="755" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1a202c">Technology Stack</text>
    
    <!-- Tech badges with proper spacing -->
    <rect x="120" y="770" width="90" height="25" rx="4" fill="#4285f4" opacity="0.1" stroke="#4285f4" stroke-width="1"/>
    <text x="165" y="788" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#4285f4">Cloud Storage</text>
    
    <rect x="230" y="770" width="90" height="25" rx="4" fill="#ea4335" opacity="0.1" stroke="#ea4335" stroke-width="1"/>
    <text x="275" y="788" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#ea4335">Cloud Functions</text>
    
    <rect x="340" y="770" width="70" height="25" rx="4" fill="#fbbc04" opacity="0.1" stroke="#fbbc04" stroke-width="1"/>
    <text x="375" y="788" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#fbbc04">BigQuery</text>
    
    <rect x="430" y="770" width="90" height="25" rx="4" fill="#34a853" opacity="0.1" stroke="#34a853" stroke-width="1"/>
    <text x="475" y="788" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#34a853">Google Looker</text>
    
    <rect x="540" y="770" width="70" height="25" rx="4" fill="#805ad5" opacity="0.1" stroke="#805ad5" stroke-width="1"/>
    <text x="575" y="788" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="500" fill="#805ad5">Terraform</text>
    
    <!-- Technical details in organized columns with better spacing -->
    <text x="120" y="820" font-family="Arial, sans-serif" font-size="11" font-weight="500" fill="#2d3748">Runtime &amp; Languages:</text>
    <text x="120" y="835" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Python 3.10 Runtime</text>
    <text x="120" y="850" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Event-driven Architecture</text>
    <text x="120" y="865" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Auto-scaling &amp; Serverless</text>
    
    <text x="320" y="820" font-family="Arial, sans-serif" font-size="11" font-weight="500" fill="#2d3748">Data Processing:</text>
    <text x="320" y="835" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Schema Auto-detection</text>
    <text x="320" y="850" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• WRITE_APPEND Mode</text>
    <text x="320" y="865" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Columnar Storage</text>
    
    <text x="520" y="820" font-family="Arial, sans-serif" font-size="11" font-weight="500" fill="#2d3748">Infrastructure:</text>
    <text x="520" y="835" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Infrastructure as Code</text>
    <text x="520" y="850" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Automated Deployment</text>
    <text x="520" y="865" font-family="Arial, sans-serif" font-size="11" fill="#4a5568">• Resource Management</text>
  </g>

  <!-- Cost Estimate Box - Better positioned with more space -->
  <g id="cost-box">
    <rect x="720" y="730" width="340" height="160" rx="8" fill="#f0fff4" stroke="#38a169" stroke-width="2"/>
    <text x="890" y="755" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1a202c">Estimated Monthly Costs</text>
    
    <text x="740" y="780" font-family="Arial, sans-serif" font-size="13" fill="#2d3748">Cloud Storage (Standard):</text>
    <text x="1030" y="780" text-anchor="end" font-family="Arial, sans-serif" font-size="13" font-weight="500" fill="#38a169">$1-3</text>
    
    <text x="740" y="805" font-family="Arial, sans-serif" font-size="13" fill="#2d3748">Cloud Functions:</text>
    <text x="1030" y="805" text-anchor="end" font-family="Arial, sans-serif" font-size="13" font-weight="500" fill="#38a169">$0-2</text>
    
    <text x="740" y="830" font-family="Arial, sans-serif" font-size="13" fill="#2d3748">BigQuery (Storage + Queries):</text>
    <text x="1030" y="830" text-anchor="end" font-family="Arial, sans-serif" font-size="13" font-weight="500" fill="#38a169">$2-5</text>
    
    <text x="740" y="855" font-family="Arial, sans-serif" font-size="13" fill="#2d3748">Google Looker:</text>
    <text x="1030" y="855" text-anchor="end" font-family="Arial, sans-serif" font-size="13" font-weight="500" fill="#4a5568">Variable*</text>
    
    <line x1="740" y1="865" x2="1040" y2="865" stroke="#e2e8f0" stroke-width="1"/>
    <text x="740" y="885" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1a202c">Total Estimated:</text>
    <text x="1030" y="885" text-anchor="end" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#38a169">$5-15/month</text>
  </g>
</svg>